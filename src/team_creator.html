<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Team Creator</title>
    <link rel="stylesheet" href="styles/creator_styles.css">
    <link rel="stylesheet" href="styles/creator_styles_autocomplete.css">
    <link rel="stylesheet" href="styles/creator_styles_filtering.css">
    <link rel="stylesheet" href="styles/creator_styles_results.css">
    <link rel="stylesheet" href="styles/creator_styles_min_values.css">
    <script src="./js/autocomplete.js"></script>
</head>
<body>
    <div class="header_bar">
        <!-- back button -->
        <input class="back_button" type="submit" value="Back" onclick="window.location='./home.html'">
        <!-- header text -->
        <h1 class="title_text"> Create your team! </h1>
        <input class="view_team_button" type="submit" value="View Team" onclick="window.location='./team_view.html'">
    </div>

    <div class="sections">

        <!-- display images of selected pokemon and their names to the left of the page -->
        <div class="selected_poke_block" id="selected_poke">
            <p class="selected_poke_text">Selected pokemon</p>
            <!-- selected pokemon images appear below -->

        </div>
        
        <!-- elements for searching/filtering for pokemon -->
        <div class="right_section">
            <div class="filtering_block">
                
                <!-- search by pokemon name -->
                <div class="search_block">
                    <div class="pokemon_name_search">
                        <!-- autocomplete: https://www.w3schools.com/howto/tryit.asp?filename=tryhow_js_autocomplete -->
                        <div class="autocomplete">
                            <input id="pokemon_name" type="text" placeholder="Pokemon name">
                        </div>
                        <script>
                            autocomplete(document.getElementById("pokemon_name"), countries);
                        </script>
                    </div>
                </div>

                <!-- filter by type -->
                <div class="type_search">
                    <!-- primary type -->
                    <select id="primary_type"> 
                        <option value="primary_type" selected>Primary Type</option>
                        <option value="bug">Bug</option>
                        <option value="dragon">Dragon</option>
                        <option value="electric">Electric</option>
                        <option value="fighting">Fighting</option>
                        <option value="fire">Fire</option>
                        <option value="flying">Flying</option>
                        <option value="ghost">Ghost</option>
                        <option value="grass">Grass</option>
                        <option value="ground">Ground</option>
                        <option value="ice">Ice</option>
                        <option value="normal">Normal</option>
                        <option value="poison">Poison</option>
                        <option value="rock">Rock</option>
                        <option value="water">Water</option>
                    </select>
                    <!-- secondary type -->
                    <select id="secondary_type"> 
                        <option value="secondary_type" selected>Secondary Type</option>
                        <option value="bug">Bug</option>
                        <option value="dragon">Dragon</option>
                        <option value="electric">Electric</option>
                        <option value="fighting">Fighting</option>
                        <option value="fire">Fire</option>
                        <option value="flying">Flying</option>
                        <option value="ghost">Ghost</option>
                        <option value="grass">Grass</option>
                        <option value="ground">Ground</option>
                        <option value="ice">Ice</option>
                        <option value="normal">Normal</option>
                        <option value="poison">Poison</option>
                        <option value="psychic">Psychic</option>
                        <option value="rock">Rock</option>
                        <option value="water">Water</option>
                    </select>
                </div>

                <!-- weak/strong against is 5x5 selection button area -->
                <div class="weak_strong_against_block">

                    <script>
                        const selectedColor = 'rgb(0, 0, 0)'; //"#000000";
                        const deselectedColor = 'rgb(254, 95, 85)'; //"#FE5F55";
                        function selectType(button) {
                            var curCol = getComputedStyle(button)['background-color'];
                            if (curCol == deselectedColor) {
                                button.style.background = selectedColor;
                            } else {
                                button.style.background = deselectedColor;
                            }
                        }
                    </script>
                    
                    <div class="weak_against_block" id="weak_against_block">
                        <p>Types weak against</p>
                        <div class="weak_against_row">
                            <input type="submit" onclick="selectType(this);" value="bug">
                            <input type="submit" onclick="selectType(this);" value="dragon">
                            <input type="submit" onclick="selectType(this);" value="electric">
                            <input type="submit" onclick="selectType(this);" value="fighting">
                            <input type="submit" onclick="selectType(this);" value="fire">
                        </div>
                        <div class="weak_against_row">
                            <input type="submit" onclick="selectType(this);" value="flying">
                            <input type="submit" onclick="selectType(this);" value="ghost">
                            <input type="submit" onclick="selectType(this);" value="grass">
                            <input type="submit" onclick="selectType(this);" value="ground">
                            <input type="submit" onclick="selectType(this);" value="ice">
                        </div>
                        <div class="weak_against_row">
                            <input type="submit" onclick="selectType(this);" value="normal">
                            <input type="submit" onclick="selectType(this);" value="poison">
                            <input type="submit" onclick="selectType(this);" value="psychic">
                            <input type="submit" onclick="selectType(this);" value="rock">
                            <input type="submit" onclick="selectType(this);" value="water">
                        </div>
                        
                    </div>

                    <div class="strong_against_block" id="strong_against_block">
                        <p>Types strong against</p>
                        <div class="strong_against_row">
                            <input type="submit" onclick="selectType(this);" value="bug">
                            <input type="submit" onclick="selectType(this);" value="dragon">
                            <input type="submit" onclick="selectType(this);" value="electric">
                            <input type="submit" onclick="selectType(this);" value="fighting">
                            <input type="submit" onclick="selectType(this);" value="fire">
                        </div>
                        <div class="strong_against_row">
                            <input type="submit" onclick="selectType(this);" value="flying">
                            <input type="submit" onclick="selectType(this);" value="ghost">
                            <input type="submit" onclick="selectType(this);" value="grass">
                            <input type="submit" onclick="selectType(this);" value="ground">
                            <input type="submit" onclick="selectType(this);" value="ice">
                        </div>
                        <div class="strong_against_row">
                            <input type="submit" onclick="selectType(this);" value="normal">
                            <input type="submit" onclick="selectType(this);" value="poison">
                            <input type="submit" onclick="selectType(this);" value="psychic">
                            <input type="submit" onclick="selectType(this);" value="rock">
                            <input type="submit" onclick="selectType(this);" value="water">
                        </div>
                        
                    </div>

                </div>

                <!-- for filtering by min value, use slider -->
                <!-- min: attack, defense, hp, special attack, special defense, speed -->
                <div class="min_values">
                    <div class="slider_row">
                        <div class="individual_slider_block">
                            <!-- attack max = 190 -->
                            <p class="slider_text">Min. Attack: 0</p>
                            <input type="range" id="min_attack" value=0 max="190" onchange="this.previousSibling.previousSibling.innerHTML='Min. Attack: '+this.value;">
                        </div>
                        <div class="individual_slider_block">
                            <!-- defense max = 250 -->
                            <p class="slider_text">Min. Defense: 0</p>
                            <input type="range" id="min_defense" value=0 max="250" onchange="this.previousSibling.previousSibling.innerHTML='Min. Defense: '+this.value;">
                        </div>
                        <div class="individual_slider_block">
                            <!-- hp max = 255 -->
                            <p class="slider_text">Min. HP: 0</p>
                            <input type="range" id="min_hp" value=0 max="255" onchange="this.previousSibling.previousSibling.innerHTML='Min. HP: '+this.value;">
                        </div>
                    </div>
                    <div class="slider_row">
                        <div class="individual_slider_block">
                            <!-- sp attack max = 194 -->
                            <p class="slider_text">Min. Sp. Attack: 0</p>
                            <input type="range" id="min_sp_attack" value=0 max="194" onchange="this.previousSibling.previousSibling.innerHTML='Min. Sp. Attack: '+this.value;">
                        </div>
                        <div class="individual_slider_block">
                            <!-- sp defense max = 250 -->
                            <p class="slider_text">Min. Sp. Defense: 0</p>
                            <input type="range" id="min_sp_defense" value=0 max="250" onchange="this.previousSibling.previousSibling.innerHTML='Min. Sp. Defense: '+this.value;">
                        </div>
                        <div class="individual_slider_block">
                            <!-- speed max = 200 -->
                            <p class="slider_text">Min. Speed: 0</p>
                            <input type="range" id="min_speed" value=0 max="200" onchange="this.previousSibling.previousSibling.innerHTML='Min. Speed: '+this.value;">
                        </div>
                    </div>
                </div>

                <div class="search_button_block">
                    <form action="team_view.html" method="post">
                        <!-- can put invisible inputs here if needed -->

                        <input type="submit" class="search_button" onclick="getInputs();" value="Search">
                    </form>
                </div>
                <script>
                    function getInputs() {
                        // pokemon name
                        var pokeName = document.getElementById("pokemon_name").value;
                        console.log("poke name: "+pokeName);

                        // poke types
                        var primaryType = document.getElementById("primary_type").value;
                        console.log("primary type: "+primaryType);
                        var secondaryType = document.getElementById("secondary_type").value;
                        console.log("secondary type: "+secondaryType);

                        // types weak against
                        const weakAgainstTypes = document.getElementById("weak_against_block").children;
                        var weakAgainst = [];
                        for (var i=1; i <= 3; i++) {
                            var row = weakAgainstTypes[i].children;
                            for (var j=0; j < row.length; j++) {
                                var curCol = getComputedStyle(row[j])['background-color'];
                                if (curCol == 'rgb(0, 0, 0)') {
                                    // console.log(row[j].value);
                                    weakAgainst.push(row[j].value)
                                }
                            }
                        }
                        console.log("weak against: "+weakAgainst);
                        // types strong against
                        const strongAgainstTypes = document.getElementById("strong_against_block").children;
                        var strongAgainst = [];
                        for (var i=1; i <= 3; i++) {
                            var row = strongAgainstTypes[i].children;
                            for (var j=0; j < row.length; j++) {
                                var curCol = getComputedStyle(row[j])['background-color'];
                                if (curCol == 'rgb(0, 0, 0)') {
                                    strongAgainst.push(row[j].value)
                                }
                            }
                        }
                        console.log("strong against: "+strongAgainst);


                        // min values
                        var minAttack = document.getElementById("min_attack").value;
                        console.log("min attack: "+minAttack);
                        var minDefense = document.getElementById("min_defense").value;
                        console.log("min defense: "+minDefense);
                        var minHP = document.getElementById("min_hp").value;
                        console.log("min hp: "+minHP);
                        var minSpAttack = document.getElementById("min_sp_attack").value;
                        console.log("min sp attack: ", minSpAttack);
                        var minSpDefense = document.getElementById("min_sp_defense").value;
                        console.log("min sp defense: "+minSpDefense);
                        var minSpeed = document.getElementById("min_speed").value;
                        console.log("min speed: "+minSpeed);

                        // window.location.href = 'http://www.google.com';
                        return false;
                    }
                </script>

            </div>
            <!-- display results of search in horizontal scrollbox at bottom of page -->
            <div class="results_block"> 
                <!-- <a onclick="document.getElementById('first').style.width='10px'"><img class=selected_poke_im id="first" src="./images/ditto.png"></a> -->
                <img class=selected_poke_img onclick="selectPoke(this)" src="./images/ditto.png">
                <img class=selected_poke_img onclick="selectPoke(this)" src="./images/dragonite.png">
                <img class=selected_poke_img onclick="selectPoke(this)" src="./images/mew.png">
                <img class=selected_poke_img onclick="selectPoke(this)" src="./images/pikachu.png">
                <img class=selected_poke_img onclick="selectPoke(this)" src="./images/vaporeon.png">
                <img class=selected_poke_img onclick="selectPoke(this)" src="./images/rhydon.png">
                <img class=selected_poke_img src="./images/ditto.png">
                <img class=selected_poke_img src="./images/ditto.png">
                <img class=selected_poke_img src="./images/ditto.png">
                <img class=selected_poke_img src="./images/ditto.png">
                <img class=selected_poke_img src="./images/ditto.png">
                <img class=selected_poke_img src="./images/ditto.png">
                <img class=selected_poke_img src="./images/ditto.png">
                <img class=selected_poke_img src="./images/ditto.png">
                <img class=selected_poke_img src="./images/ditto.png">
                <img class=selected_poke_img src="./images/ditto.png">
                <img class=selected_poke_img src="./images/ditto.png">
                <img class=selected_poke_img src="./images/ditto.png">
                <img class=selected_poke_img src="./images/ditto.png">
            </div>
        </div>
    </div> 
    <script>
        function selectPoke(img) {
            const numSelectedPoke = document.getElementById("selected_poke").children.length;
            if (numSelectedPoke > 6) {
                alert("Cannot select anymore pokemon (max 6)!");
                return;
            }

            const clone = img.cloneNode(true);
            // set clone's onclick to remove itself from the selected pokemon when its clicked
            clone.onclick = function() { deselectPoke(clone); }
            document.getElementById("selected_poke").appendChild(clone);
        } 
        function deselectPoke(img) {
            img.remove();
        }
    </script>
</body>
</html>